# 通讯

## 本次主题：基于OOP方法编写串口助手类

内容目标：

（1）充分体会OOP中类的设计方法。

（2）能够轻松开发一个串口操作助手。

串口知识回顾：

串口在电脑设备中，查看的就是COM口。

1.常见的串口

（1）RS-232接口：通常适合于数据传输频率在0~20000bps范围的通信。在PC机上通常都是COM串口。

    不足：抗干扰能力差，通信距离短，速率低。

（2）RS-422/485接口：传输速度和通信距离变得非常远（1200m），并且在一条平衡总线上连接最多10个接收器。

2.串行通信的基本参数

（1）波特率：是指串行通信中每1秒所传送的数据位数，单位是bps。也就是传输速度。

    比如发送一个字符需要8位，如果波特率是4800bps传输，则每秒可以传输600个字符。

（2）起始位：起始位表示字符传输的开始。在通信线上，没有数据传输时处于逻辑“1”状态。当发送一个字符

    数据时，首先发出一个“0”信号，这个逻辑低电平就是起始位。接收设备检测到低电平后，就准备开始接收。

（3）数据位：当接收设备收到起始位后，紧挨着的就是数据位，数据位的个数可以是5、6、7、8位。

    在字符串数据传送的过程中，数据位从最低有效位开始传输。

（4）奇偶校验位：数据位发送完以后，就可以发送奇偶校验位，用于有限差错的检查。通信双方需要约定一致的

    奇偶校验方式。

（5）停止位：在奇偶校验位或者数据位（无奇偶校验位时）之后是停止位，它可以是1位，1.5位或者2位，停止位

    是数据结束的标志。

3.异步传输中的一帧数据组成

【发送端】->停止位（1-2）->奇偶校验位（1位）->数据位（7-8个）->起始位（0）【接收端】

串口助手类的设计

准备工作：自学一个进制转换类助手，能够完成十进制、16进制、汉字、英文、byte[]之间的转换。

1.设置相关的属性

（1）属性：串口操作对象。

（2）属性：获取计算机串口列表。

（3）属性：进制转换对象。

（4）构造方法：完成属性初始化和串口参数默认值。

2.设置相关的方法

（1）打开或关闭串口（端口）。

（2）编写发送数据的方法。

（3）编写接收数据的方法。

3.串口助手UI设计和任务编写

## 虚拟串口工具

VSPD，可以实现虚拟的川口。
